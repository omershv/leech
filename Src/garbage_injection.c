#include "main.h"
#include "garbage_injection.h"
#include <stdlib.h>

uint8_t buff[102];


static uint8_t _0xc_table[11][4] = {
		{00, 02, 0b00000000, 0b00},
		{00, 02, 0b00000001, 0b00},
		{00, 02, 0b00000011, 0b00},
		{00, 02, 0b00000111, 0b00},
		{00, 02, 0b00001111, 0b00},
		{00, 02, 0b00011111, 0b00},
		{00, 02, 0b00111111, 0b00},
		{00, 02, 0b01111111, 0b00},
		{00, 02, 0b11111111, 0b00},
		{00, 02, 0b11111111, 0b01},
		{00, 02, 0b11111111, 0b11},
};


static const uint8_t reg_0x6[] = { 0x00, 0x02, 0x00, 0x04};

uint8_t garb[] = {0xB,
		0x58, 0x39, 0xF9, 0x6, 0xE9, 0xA, 0x44, 0xCD, 0xF4, 0xEC, 0x1, 0x8, 0xA0, 0xCA, 0xCD, 0x23,
		0x55, 0xD8, 0x79, 0x3A, 0xB9, 0xF7, 0x58, 0x86, 0x65, 0xDD, 0xF3, 0x5F, 0x67, 0x8B, 0x6, 0x7E,
		0x7D, 0x6C, 0x64, 0x8C, 0x19, 0xE9, 0xC6, 0xA9, 0x3F, 0xF4, 0x33, 0x9D, 0x37, 0xDF, 0x9E, 0x24,
		0x45, 0x58, 0xEE, 0x42, 0x1E, 0x71, 0x3, 0x8B, 0x70, 0x32, 0xFA, 0x45, 0xEF, 0x72, 0x91, 0x6B,
		0x2F, 0x17, 0x71, 0x31, 0x7F, 0xA2, 0x1A, 0xCA, 0xF2, 0x0, 0xF6, 0x7E, 0x6F, 0xBA, 0xCB, 0x40,
		0xC4, 0xAC, 0x28, 0xF1, 0x44, 0xAA, 0xE9, 0xA3, 0x9F, 0x96, 0x14, 0xC1, 0x6, 0xF4, 0x5C, 0x56,
		0x9, 0xCD, 0xBC, 0xC6, 0xB4,};

const uint8_t* get_injection_garbage(uint8_t reg)
{
	memset(buff, 0, sizeof(buff));
	if (reg == 0xc)
	{
		return _0xc_table[10];
	}
	else if (reg == 0x6)
	{
		return reg_0x6;
	}
	else
	{
		//return buff;
		//printf("garbage\r\n");
		for(uint8_t i = 2; i < sizeof(buff); i++)
		{
			buff[i] = /*garb[i];*/rand();
			if((i-2)%8==0)
			{
				buff[i]=0x01;
			}
			printf("0x%x, ", buff[i]);
			if((i-2+1)%16==0)
			{
				//printf("\r\n");
			}
		}
		//printf("\r\n");
		buff[0] = 1;//rand();
		buff[1] = 100;
		return buff;
	}
}


void init_injection_garbage()
{

}


void destroy_injection_garbage()
{

}
